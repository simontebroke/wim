import{jsx as t}from"react/jsx-runtime";import{pipe as e,useTransform as n,motionValue as o,frame as i,mix as r,useMotionValue as d,animate as u,useReducedMotion as s,useSpring as a,LayoutGroup as c,MotionConfig as l,motion as f,AnimatePresence as h}from"motion/react";import{useState as p,useLayoutEffect as g,useEffect as m,useInsertionEffect as x}from"react";import{createPortal as w}from"react-dom";import{noop as y}from"motion-utils";let v=null;function B(){const t=new Set;function e(){t.forEach((t=>t.show()))}function n(){t.forEach((t=>t.hide()))}return{on:o=>(t.size||(document.body.addEventListener("mouseenter",e),document.body.addEventListener("mouseleave",n)),t.add(o),()=>{t.delete(o),0===t.size&&(document.body.removeEventListener("mouseenter",e),document.body.removeEventListener("mouseleave",n))})}}function z(t){const[e,n]=p(!0);return m((()=>(v||(v=B()),v).on({show:()=>{e||(t(),n(!0))},hide:()=>n(!1)})),[e]),e}function S(t){return e=>{"mouse"===e.pointerType&&t(e)}}function E(t){return S((e=>{0===e.button&&t(e)}))}function b(t){let e=function(t){return t.closest("[data-cursor]")}(t);return e?[e.dataset.cursor,e]:(e=t.closest('a, button, input[type="button"]:not(:disabled)'),e?["pointer",e]:(e=function(t){return"none"===window.getComputedStyle(t).userSelect?null:t.closest("p, textarea:not(:disabled), input[type='text']:not(:disabled), h1, h2, h3, h4, h5, h6")}(t),e?["text",e]:["default",null]))}let L,C,P=null,T={type:"default",isPressed:!1,fontSize:null,targetBoundingBox:null};function j(){const t=new Set;function e(e){T={...T,...e},t.forEach((t=>t(T)))}const n=E((()=>{T.isPressed||e({isPressed:!0})})),o=E((()=>{T.isPressed&&e({isPressed:!1})})),i=S((({target:t})=>{if(!t)return;const[n,o]=b(t);let i=!1,r={};n!==T.type&&(r.type=n,i=!0);const d="pointer"===n&&o?o.getBoundingClientRect():null;if(d!==T.targetBoundingBox&&(r.targetBoundingBox=d,i=!0),"text"===n){const{fontSize:e}=window.getComputedStyle(t),n=e?parseInt(e):null;n!==T.fontSize&&(r.fontSize=n,i=!0)}else T.fontSize&&(r.fontSize=null,i=!0);i&&e(r)}));return{onChange:e=>(t.size||(window.addEventListener("pointerover",i),window.addEventListener("pointerdown",n),window.addEventListener("pointerup",o)),t.add(e),()=>{t.delete(e),t.size||(window.removeEventListener("pointerover",i),window.removeEventListener("pointerdown",n),window.removeEventListener("pointerup",o))})}}function $(){const[t,e]=p({...T});return m((()=>(P||(P=j()),P).onChange((t=>{e(t)}))),[t]),t}function I(){return L||function(){L=o(0),C=o(0);let t=0,e=0;function n(){L.set(t),C.set(e)}"undefined"!=typeof window&&window.addEventListener("pointermove",S((o=>{t=o.clientX,e=o.clientY,i.update(n)})))}(),{x:L,y:C}}function R(t,e,o){return n((()=>r(t.get(),e.get(),o.get())))}function X(){const t=document.createElement("style");return t.textContent='\n      * {\n          cursor: none !important;\n      }\n          \n      [data-motion-cursor="pointer"] {\n          background-color: #333;\n      }\n    ',document.head.appendChild(t),()=>{document.head.removeChild(t)}}const Y={x:0,y:0},k={x:.5,y:.5},q={duration:0},A={width:"auto",height:"auto"},D={stiffness:1e3,damping:100};function F({follow:o=!1,center:i=(o?Y:k),offset:r=Y,spring:v=!!o&&D,snapToTarget:B=!1,matchTextSize:S=!0,children:E,...b}){const L=s();var C;x((C=!L&&!o)?X:y,[C]);const P=I(),T=function(t,e){return{x:n((()=>t.x.get()+e.x)),y:n((()=>t.y.get()+e.y))}}(P,r),j=a(T.x,v||void 0),F=a(T.y,v||void 0),H=()=>{const t=T.x.on("change",(e=>{j.jump(e),t()})),e=T.y.on("change",(t=>{F.jump(t),e()}))},J=$(),K=z(H),{x:M,y:N}=function(t,e,n){const o=d(0),i=d(0),r=d(0),s=R(t.x,i,o),a=R(t.y,r,o);return m((()=>{if(!e)return;n.targetBoundingBox&&(i.set(n.targetBoundingBox.left+n.targetBoundingBox.width/2),r.set(n.targetBoundingBox.top+n.targetBoundingBox.height/2));const t=u(o,n.targetBoundingBox?.9:0);return()=>t.stop()}),[n.targetBoundingBox,e]),{x:s,y:a}}(v?{x:j,y:F}:P,B,J),{width:O,height:Q}=E?A:function(t,e,{matchPointerSize:n,matchTextSize:o}){switch(t){case"pointer":return n&&e.targetBoundingBox?e.targetBoundingBox:{width:30,height:30};case"text":return o&&e.fontSize?{width:4,height:e.fontSize}:{width:4,height:20};default:return{width:16,height:16}}}(J.type,J,{matchPointerSize:B,matchTextSize:S}),U=function({x:t,y:n},o){const[i,r]=p(void 0!==t.prev||void 0!==n.prev);return x((()=>{if(i)return;const d=()=>{r(!0),o(),u()},u=e(t.on("change",d),n.on("change",d));return()=>u()}),[t,n,i]),i}(P,H);return function(t){const[e,n]=p(null);return g((()=>{n(document.body)}),[]),e?w(t,e):null}(U?t(c,{children:t(l,{transition:L?q:b.transition||G,children:t(f.div,{layout:!0,"data-motion-cursor":o?"follow":"pointer","data-framer-portal-id":"motion-cursor",initial:"exit",exit:"exit",...b,variants:{default:{opacity:1,scale:1},exit:{opacity:0,scale:0},pressed:o?{}:{scale:.9},...b.variants},animate:["default",J.type,K?J.isPressed?"pressed":"":"exit"],transformTemplate:(V=i,(t,e)=>`translate(-${100*V.x}%, -${100*V.y}%) ${e}`),style:{width:O,height:Q,borderRadius:o?0:20,zIndex:o?99998:99999,willChange:"transform",contain:"layout",overflow:"hidden",originX:i.x,originY:i.y,...b.style,x:M,y:N,top:0,left:0,position:"fixed",pointerEvents:"none"},children:t(h,{children:E})})})}):null);var V}const G={duration:.15,ease:[.38,.12,.29,1]};export{F as Cursor};
